<!DOCTYPE html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="css/draw.css" type="text/css" />
	<link rel="stylesheet" href="css/spectrum.css" type="text/css" />
	<link rel="stylesheet" href="css/sp-dark.css" type="text/css" />
	<script type="text/javascript" src="js/jquery.min.js"></script>
	<script type="text/javascript" src="js/spectrum.js"></script>
	<script type="text/javascript" src="js/paper-core.min.js"></script>
	<script type="text/javascript" src="js/db.js"></script>
    <script type="text/javascript">
      var CLIENT_ID = '250137569211-thdglqpmqkfiqr5t3l7q3a77947qv7vr.apps.googleusercontent.com';
      var SCOPES = ['https://www.googleapis.com/auth/drive.appfolder'];

      function checkAuth() {
        gapi.auth.authorize(
          {
            'client_id': CLIENT_ID,
            'scope': SCOPES.join(' '),
            'immediate': true
          }, handleAuthResult);
      }

      function handleAuthResult(authResult) {
        var authorizeDiv = document.getElementById('authorize-div');
        if (authResult && !authResult.error) {
          authorizeDiv.style.display = 'none';
          loadDriveApi();
        } else {
          authorizeDiv.style.display = 'inline';
        }
      }

      function handleAuthClick(event) {
        gapi.auth.authorize(
          {client_id: CLIENT_ID, scope: SCOPES, immediate: false},
          handleAuthResult);
        return false;
      }

      function loadDriveApi() {
        gapi.client.load('drive', 'v2', printAppfolderMetadata);
      }

	  function printAppfolderMetadata() {
		var request = gapi.client.drive.files.get({
			'fileId': 'appfolder'
		});
		
		request.execute(function(resp) {
			var p = $('<p>');
			p.text(resp.title);
			p.attr('id', resp.id);
			$("#control").append(p);
			console.log('Id: ' + resp.id);
			console.log('Title: ' + resp.title);
		});
	  }

	  function listFiles(callback) {
		var retrievePageOfFiles = function(request, result) {
			request.execute(function(resp) {
				result = result.concat(resp.items);
				var nextPageToken = resp.nextPageToken;
				if (nextPageToken) {
					request = gapi.client.drive.files.list({
						'pageToken': nextPageToken
					});
					retrievePageOfFiles(request, result);
				} else {
					callback(result);
				}
			});
		}
		var initialRequest = gapi.client.drive.files.list({
			'q': '\'appfolder\' in parents'
		});
		retrievePageOfFiles(initialRequest, []);
	  }

    </script>
    <script src="https://apis.google.com/js/client.js?onload=checkAuth"></script>
	<title>sketch pad</title>
</head>
<body>
	<div id="ctrlr"><i class="icon"><i></i></i></div>
	<div id="control">
		<div id="authorize-div" style="display: none">
			<span>Authorize Google Drive</span>
			<button id="authorize-button" onclick="handleAuthClick(event)">Authorize</button>
		</div>

		<label for="back-color" class="controls">background: </label>
			<input type="text" id="back-color">

		<label for="pen-color" class="controls">pen: </label>
			<input type="text" id="pen-color">

		<br><input type="hidden" id="name">
		<br><br>
		<label for="pen-size" class="controls">pen size: </label>
		<select id="pen-size">
			<option selected>1</option>
			<option>2</option>
			<option>3</option>
			<option>4</option>
			<option>5</option>
			<option>6</option>
			<option>7</option>
			<option>8</option>
			<option>9</option>
			<option>10</option>
			<option>11</option>
			<option>12</option>
			<option>13</option>
			<option>14</option>
			<option>15</option>
			<option>16</option>
			<option>17</option>
			<option>18</option>
			<option>19</option>
			<option>20</option>
		</select>

		<span class="controls">opacity: </span>
		<select id="opacity">
			<option value="1" selected>100%</option>
			<option value="0.9">90%</option>
			<option value="0.8">80%</option>
			<option value="0.7">70%</option>
			<option value="0.6">60%</option>
			<option value="0.5">50%</option>
			<option value="0.4">40%</option>
			<option value="0.3">30%</option>
			<option value="0.2">20%</option>
			<option value="0.1">10%</option>
		</select>
		<br><br>
		<span style='margin-left:15px' class='controls' id='undo' title=' undo: ctrl+Z'> &nbsp; </span>
		<span class='controls' id='redo' title='redo: ctrl+shift+Z'> &nbsp; </span>
		<span class='controls' id='clear' title='new (clears board): shift+N'> &nbsp; </span>
		<span class='controls' id='pic' title='picture: shift+P'> &nbsp; </span>
		<span class='controls' id='graph' title='graph: shift+G'> &nbsp; </span>
		<br><br>
		<input type="text" id="book-name" placeholder="book name">
		<button id="newbook">create</button>
		
	</div>

	<canvas id="canvas" resize="true" data-paper-resize="true"></canvas>
	<div id="message"></div>
	<script type="text/javascript" src="js/app.js"></script>

</body>
</html>